# Cloudflare Workers 配置文件
name = "kemono-shares-api"
main = "src/worker.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat", "global_fetch_strictly_public"]

# Pages 配置
pages_build_output_dir = "out"

# 构建配置
[build]
command = "npm run build:cloudflare"
cwd = "."

# Pages 构建配置
[pages_build]
command = "npm run build:pages"
output_dir = "out"

# 环境配置
[env.production]
name = "kemono-shares-api"

[env.development]
name = "kemono-shares-api-dev"

# KV 命名空间配置
[[kv_namespaces]]
binding = "SHARE_DATA_KV"
id = "77b81f5b787b449e931fa6a51263b38c"
preview_id = "2d7d8b533f3049b89d808fbb569bb09c"

# 全局环境变量
[vars]
NODE_ENV = "production"
NEXT_PUBLIC_APP_URL = "https://2kawaii.com"
KIE_AI_40_BASE_URL = "https://api.kie.ai"
KIE_AI_USER_ID = "j2983236233@gmail.com"
KIE_AI_EDGE_BASE = "https://api.kie.ai/api/v1"
CLOUDFLARE_R2_ACCOUNT_ID = "9a5ff316a26b8abb696af519e515d2de"
CLOUDFLARE_R2_BUCKET_NAME = "kemono-uploadimage"
CLOUDFLARE_R2_PUBLIC_URL = "https://pub-9ea5461e9e8b418caecb7e5b7748bdea.r2.dev"
CLOUDFLARE_R2_AFTERIMAGE_BUCKET_NAME = "kemono-afterimage"
CLOUDFLARE_R2_AFTERIMAGE_PUBLIC_URL = "https://pub-d00e7b41917848d1a8403c984cb62880.r2.dev"

# 生产环境变量
[env.production.vars]
NODE_ENV = "production"
NEXT_PUBLIC_APP_URL = "https://2kawaii.com"

# 开发环境变量
[env.development.vars]
NODE_ENV = "development"
NEXT_PUBLIC_APP_URL = "https://kemono-shares-api-dev.y2983236233.workers.dev"